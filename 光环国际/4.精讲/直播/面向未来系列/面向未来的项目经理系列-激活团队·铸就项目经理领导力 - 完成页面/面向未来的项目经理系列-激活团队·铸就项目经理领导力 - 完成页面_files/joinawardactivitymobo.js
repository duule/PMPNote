function setCookie(a,b,c,d,e,f){document.cookie=a+"="+escape(b)+(c?"; expires="+c:"")+(d?"; path="+d:"")+(e?"; domain="+e:"")+(f?"; secure":"")}function change(){lapIndex==endLap?ok():endLap>lapIndex&&(changeColor(),clearTimeout(joinawardtimer),joinawardtimer=setTimeout(change,timeInterval))}function changeColor(){curIndex>0&&(tdImg[curIndex-1].className=""),curIndex==tdLen&&(curIndex=0),tdImg[curIndex].className="Naward_active",curIndex++,timeInterval+=timeAdd,lapIndex++}function endAward(){lapIndex>=endLap?dspAward():(changeColor(),clearTimeout(joinawardtimer),joinawardtimer=setTimeout(endAward,timeInterval))}function show_tip(a){var b,c,d;a&&(hasshow||(b="position:fixed;left:0;top:0;background:rgba(0,0,0,0.8);filter:alpha(opacity=80);width:100%;height:100%;z-index:100;",c='<div id="weixin-tip" style="'+b+'"><p style="text-align:center;margin-top:10%;padding:0 5%;position:relative;"><img src="http://pubimage.sojump.com/20150206_112654_0QfUg3uXQkik_PEgxlW4_Q" alt="微信打开"/></p></div>',$("body").append(c),d="undefined"!=typeof window.innerHeight?window.innerHeight:document.documentElement.clientHeight,$("#weixin-tip").height(d),hasshow=!0,$("#weixin-tip").click(function(){$(this).hide()})),$("#weixin-tip").show())}function closeAlert(){var a=document.getElementById("alert_box");a.style.display="none",a.callback&&a.callback()}function alertNew(a,b){var c=document.getElementById("alert_box");c?document.getElementById("pop_box_msg").innerHTML=a:(c=document.createElement("div"),c.id="alert_box",alertHtml="<div style='position:fixed;*position: absolute;width:100%;height:100%;opacity:0.5;filter:alpha(opacity=50);background-color:black;z-index:99998;top:0px;left:0px;'></div><div style='min-height: 160px;width:320px;margin-left:-160px;margin-top: -80px;position:fixed;*position: absolute;z-index:99999;top:50%;left:50%;background-color:white;border-radius:4px;'><div style='font-size:18px;color:#000;font-weight:600;padding: 26px 0px 10px;width:100%;text-align:center;border-radius:8px 8px 0 0;vertical-align: middle;z-index: 1;'><div>系统提示</div></div><div style='width: 100%;border-radius: 0 0 8px 8px; z-index: 1;'><div style='min-height: 50px;padding:6px 10px 10px;font-size: 15px;line-height: 22px;text-align: center;' id='pop_box_msg'>"+a+"</div>"+"<div style='width:100%;height: 50px;text-align:center;border-top:1px solid #D2D3D5;'><button style='display:inline-block;width:100%;font-size:18px;height:50px;box-sizing:border-box;line-height:50px;color:#3296FA;text-align: center;text-decoration: none;border: none;background: none;outline:none;cursor:pointer;' onclick='closeAlert();'>确定</button></div>"+"</div></div>",c.innerHTML=alertHtml,document.body.appendChild(c)),c.style.display="",c.callback=b||""}function getaward(){return"-1"==joinactivity?(alertNew("此为预览状态不能抽奖！"),void 0):window.hja?(alertNew("很抱歉，您已经参与过此问卷的抽奖！"),void 0):0==window.valueMatch?(alertNew("很抱歉，您的得分不符合条件，不能参与抽奖！"),void 0):isApp&&window.isWeiXin?(alertNew("此问卷抽奖需要在浏览器中打开才能进行，请按提示操作！"),show_tip(!0),void 0):(clearTimeout(joinawardtimer),awardTd.innerHTML="<img src='//image.wjx.com/images/WJX/award/loading_flower.gif' alt=''/>",joinawardtimer=setTimeout(change,timeInterval),void 0)}function ClickAward(a){var c,d,e,b=adlist[a];addtolog(3),c="jpckey",d=getCookie(c),e=document.createElement("img"),e.src="//sojump.cn-hangzhou.log.aliyuncs.com/logstores/awardstat/track.gif?APIVersion=0.6.0&adid="+awardid+"&adorder="+a+"&key="+encodeURIComponent(d)+"&activity="+activity+"&joinid="+joinactivity+"&jpm="+(window.jpmatch||0),setTimeout(function(){window.location.replace(b)},500)}function init(){var c,d,e,f,g,h,i,j,k,l,m,n,o,a=document.getElementById("tbAward");if(a.rows.length,c=a.getElementsByTagName("td"),d=tdLen/2,e=awardData.split("§"),e.length!=d)return alertNew("此问卷抽奖活动未启动，请稍等"),void 0;for(f=[0,1,2,3],window.isRandShowAward&&1==window.isRandShowAward&&(f=shuffle(f)),g=0;tdLen>g;g++)h=new Object,0==g%2?(i=f[g/2],3==i&&(awardendindex=g),j=e[i].split("〒"),h.name=j[0],k=j[1].split(","),h.value=parseInt(k[0]),k.length>1&&(awardid=k[1]),j[2]&&(h.isBaoXian=!0,h.Link=j[2],iwbx=!0,j[2].indexOf(".apk")>-1&&(isApp=!0),k[1]&&parseInt(k[1])==k[1]&&(awd=parseInt(k[1]))),j.length>=5&&(h.ismultile="1"==j[3],choosetxt=j[4])):(h.name="谢谢参与",h.value=0),awardObjs.push(h);for(g=0;g<c.length;g++)g!=d||(awardTd=c[g]);for(tdImg.push(c[0]),tdImg.push(c[1]),tdImg.push(c[2]),tdImg.push(c[5]),tdImg.push(c[8]),tdImg.push(c[7]),tdImg.push(c[6]),tdImg.push(c[3]),tdLen=tdImg.length,g=0;g<tdImg.length;g++)tdImg[g].innerHTML=getHtml(g);window.hja&&(l="award_"+activity,m="",n="",window.localStorage&&(m=localStorage[l],n=localStorage[l+"name"]),m&&0==m.indexOf("http")&&(o=localStorage[l+"tip"],a.parentNode.innerHTML="恭喜您抽中了"+n+"，如已领取请忽略！<br/><div style='text-align:center;'><a href='javascript:' tiptext='"+o+"' aval='"+m+"' onclick='receiveAward(this);' class='button white' target='_blank' style='color:#fff; background:#e87814;'>立即领取</a></div>"))}function receiveAward(a){var b=a.getAttribute("tiptext"),c=a.getAttribute("aval");b?alertNew(b,function(){window.location=c}):window.location=c}function ok(){var a="/joinnew/joinawardactivitymobo.ashx?t="+(new Date).valueOf()+"&activity="+activity+"&joinactivity="+joinactivity+"&v="+(window.isAValid||"");iwbx&&(a+="&iwbx=1"),awd&&(a+="&awd="+awd),window.sa&&(a+="&sa="+encodeURIComponent(sa)),window.ea&&(a+="&ea="+encodeURIComponent(ea)),window.gender&&(a+="&ge="+encodeURIComponent(gender)),window.marriage&&(a+="&marr="+encodeURIComponent(marriage)),window.education&&(a+="&educ="+encodeURIComponent(education)),window.jpmatch&&(a+="&jpm="+encodeURIComponent(jpmatch)),window.jpmatch&&awd&&window._czc&&_czc.push(["_trackEvent","jpm"+window.jpmatch,awd]),$.ajax({type:"get",url:a,success:function(a){var b,c,d,e,f,g,h,i,j;6==a&&(a=awardendindex),b=a,c=parseInt(b),awd&&c==b&&awardObjs[c]&&awardObjs[c].value&&awardObjs[c].isBaoXian&&(d=document.createElement("img"),e=document.getElementById("divAward"),d.style.display="none",f=window.cqType||"",g=$("#toptitle h1").html()||"",g=$.trim(g),h=e.getAttribute("province"),i=e.getAttribute("city"),j="//sojump.cn-hangzhou.log.aliyuncs.com/logstores/awardactivity/track.gif?APIVersion=0.6.0&",d.src=j+"award="+awd+"&activity="+activity+"&qtype="+f+"&name="+encodeURIComponent(g)+"&province="+encodeURIComponent(h)+"&city="+encodeURIComponent(i)+"&isVip="+window.isVip,e.appendChild(d),e.appendChild(d)),finishAward(b)},error:function(){finishAward(1)}})}function finishAward(a){clearTimeout(joinawardtimer),a||(awardNum=1),awardNum=parseInt(a),awardNum==a&&tdImg[awardNum]||(awardNum=1),endLap=awardNum,3>endLap&&(endLap+=tdLen),lapIndex=0,4>endLap?(timeAdd=400,timeInterval=400):6>endLap?(timeAdd=200,timeInterval=300):8>endLap?(timeAdd=150,timeInterval=200):(timeAdd=100,timeInterval=200),joinawardtimer=setTimeout(endAward,timeInterval)}function dspAward(){var a,b,c,d,e,f,g,h;if(clearTimeout(joinawardtimer),a="award_"+activity,setCookie(a,"1",null,"/","",null),window.hja=1,awardObjs[awardNum].value)if(awardTd.innerHTML="<a class='fastA' href='javascript:;'>恭喜中奖</a>",awardObjs[awardNum].isBaoXian)if(awardObjs[awardNum].ismultile){for(b="<div class='shade_wrap'></div><div class='prize_box'><div style='font-size:18px;color:#000;font-weight:600;padding: 0px 0px 10px;width:100%;text-align:center;border-radius:8px 8px 0 0;vertical-align: middle;z-index: 1;'>",c=awardObjs[awardNum].Link.split("¤"),d="",window.ToolTipText&&(d=window.ToolTipText),b+="<div class='p_headTit'><h4>恭喜您抽中</h4><p>"+d+"</p></div>",b+="<div class='p_cont'><p class='p_cont_desc'>"+choosetxt+"</p>",b+="<div class='peizeList'>",e=0;e<c.length;e++)f=c[e].split("|"),2==f.length&&(2>e?(b+="<div class='peizeList'  onclick='ClickAward("+e+");'><div class='prizeItem'><div class='prizename'>"+f[0]+"</div><div class='getBtn'><img src='/images/miaob@2x.png' style='width:8px;' alt=''><span style='margin-left: 15px;'>领取奖品</span></div></div></div>",adlist.push(f[1])):2==e&&(b+="</div><div style='text-align: center;padding:18px 20px 30px;'>	<a style='color:#FE8000;text-decoration: none;font-size:16px;font-weight:normal' href='javascript:void(0)'  onclick='ClickAward("+e+");'>"+f[0]+">></a>"));b+="</div></div></div>",g=document.getElementById("alert_box"),g?g.innerHTML=b:(g=document.createElement("div"),g.id="alert_box",g.innerHTML=b,document.body.appendChild(g)),g.style.display=""}else awardTd.innerHTML="<div style='text-align:center;'><a href='"+awardObjs[awardNum].Link+"'  target='_blank' style='color:#fff;text-decoration:underline;'>立即领取</a></div>",d="",d=window.ToolTipText?window.ToolTipText:divAward.getAttribute("TipText"),h=d,window.notDisplayName||(h="恭喜您获得"+awardObjs[awardNum].name+"\n"+h),alertNew(h,function(){window.localStorage&&(localStorage[a]=awardObjs[awardNum].Link,localStorage[a+"name"]=awardObjs[awardNum].name,localStorage[a+"tip"]=d),addtolog(3),setTimeout(function(){var a=awardObjs[awardNum].Link;window.location.replace(a)},1e3)});else{if(awardObjs[awardNum].value>100||!iwxh)return changeColor(),awardTd.innerHTML="<a class='fastA' href='javascript:;'>感谢参与</a>",window.rurl&&alertNew("感谢您的参与,祝您下次好运!",function(){window.location=rurl}),void 0;awardTd.innerHTML="<a style='color:#fff;text-decoration:underline;font-size:14px;' id='lnkDialog' href='#dialog' data-rel='dialog' data-transition='pop' >输入手机号码</a>",$("#dialogTitle").html("恭喜您抽中了"+awardObjs[awardNum].name)}else awardTd.innerHTML="<a class='fastA' href='javascript:;'>感谢参与</a>",window.rurl&&alertNew("感谢您的参与,祝您下次好运!",function(){window.location=rurl})}function provideMobile(){var c,a=$("#mobile1").val(),b=/^\d{11}$/;return b.exec(a)?a!=$("#mobile2").val()?(alertNew("两次手机号码输入不一致，请重新输入！"),void 0):(c="/joinnew/joinawardprovidemobo.ashx?t="+(new Date).valueOf()+"&activity="+activity+"&joinactivity="+joinactivity+"&mobile="+a,$.ajax({type:"get",url:c,success:function(b){"2"==b?(awardTd.innerHTML="参数错误",$(".ui-dialog").dialog("close")):"3"==b?alertNew("手机号码输入不正确"):"4"==b?(awardTd.innerHTML="您没有抽中奖品",$(".ui-dialog").dialog("close")):"5"==b?(alertNew("请不要重复提交"),$(".ui-dialog").dialog("close")):"1"==b&&(alertNew("我们会在2个工作日内将话费充值到您的手机"+a),awardTd.innerHTML="中奖手机号码<br/>"+a,$(".ui-dialog").dialog("close"))}}),void 0):(alertNew("手机号码格式错误，请重新输入！"),void 0)}function GetRnd(a,b){return parseInt(Math.random()*(b-a+1))}function getHtml(a){var b,c,d,e,f,g,h;return awardObjs[a].value?(b="<div style='color:#ff4801;margin-top:10px;' onclick='if(this.title)alertNew(this.title);'>",c=awardObjs[a].name,d=/^(\d+(\.\d+)?)/,e=c.match(d),e&&e.length>=2&&(f=e[1].length,g=c[f],h=c.substr(f+1),c="<span style='font-size:20px;'>"+e[1]+"</span>"+g+"<br/>"+h),b+=c,b+="</div>"):"<span style='color:#888888;font-size:12px;'>感谢参与</span>"}function shuffle(a){var b,c,d=a.length;if(d)for(d--;d>=0;)c=Math.floor(Math.random()*(d+1)),b=a[c],a[c]=a[d],a[d]=b,d--;return a}var joinawardtimer,fstImgHtml,awardObjs=new Array,awardTd=null,tdImg=new Array,tdLen=8,curIndex=0,lapIndex=0,endLap=9,timeInterval=200,timeAdd=1,iwxh=!1,iwbx=!1,awd=0,backColor="#ffe297",isApp=!1,hasshow=!1,awardendindex=6,choosetxt="",awardNum=1,adlist=[],awardid="";init();