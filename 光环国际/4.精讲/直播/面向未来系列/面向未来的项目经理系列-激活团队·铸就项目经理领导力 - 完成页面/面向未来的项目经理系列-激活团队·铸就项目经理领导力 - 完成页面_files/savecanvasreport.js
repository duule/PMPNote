function showEle(a){a.style.display=""}function hideEle(a){a.style.display="none"}function employeeImage(a,b,c){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,d=window.location.href.toLowerCase(),e=d.indexOf("/user/")>-1||d.indexOf("resultquery.aspx")>-1,f=d.indexOf("/detail.aspx")>-1;return e||f?(divContent=$(a).parent().parent()[0],"divDownLoad"==a.parentNode.id&&(divContent=divContent.parentNode),"divattrsign"==divContent.id&&(divContent=divContent.parentNode.parentNode),$(".not_wrap").hide()):window.isMobile&&(g=document.getElementById("divCepingResult"),window.divdsc&&""==divdsc.style.display&&(divContent=divdsc),g&&""==g.style.display&&(divContent=g)),h=window.navigator.userAgent.toLowerCase(),c&&window.divContent&&(i=divContent.clientHeight,i>4500)?-1==h.indexOf("wxwork")&&h.toLowerCase().indexOf("micromessenger")>-1?(window.location.href=c,void 0):(j=document.getElementById("saveWxCeshiReport"),k=j.getElementsByTagName("img")[0],k.src=k.getAttribute("xsrc"),PDF_launch("saveWxCeshiReport",400,380),void 0):(joinId=b||window.joinId||"",l=a,l.style.visibility="hidden",m=document.getElementById("divSetDisplay"),n=document.getElementById("hrefSetReport"),m&&hideEle(m),n&&hideEle(n),window.isMobile&&$(".ranking__btn").hide(),isCache?($("#showImgBox").show().prev().hide(),l.style.visibility="visible",!1):(o=divContent.clientWidth,p=divContent.clientHeight,q=document.createElement("canvas"),q.width=2*o,q.height=2*p,q.style.width=o+"px",q.style.height=p+"px",r=q.getContext("2d"),r.scale(2,2),s=function(a){var b=function(a){var b=[];return Array.prototype.forEach.call(a,function(a){(a.src.indexOf("pubnew.paperol.cn")>-1||a.src.indexOf("pubnewfr.paperol.cn")>-1||a.src.indexOf("pubali.paperol.cn")>-1||a.src.indexOf("pubalifr.paperol.cn")>-1)&&b.push(a)}),b},c=function(b){var f=b.src,g=f.replace("pubnew.paperol.cn",e).replace("pubnewfr.paperol.cn",e).replace("pubali.sojump.cn",e).replace("pubalifr.sojump.cn",e);b.src=g,b.onload=function(){d++,a[d]?c(a[d]):t()}},d=0,e="pubref.paperol.cn";a=b(a),a.length>0?c(a[d]):t()},t=function(){p>4900&&(p=4900),setTimeout(function(){html2canvas(divContent,{canvas:q,height:p,useCORS:!0,logging:!0}).then(function(a){var b,c,d,e,h,i,j,k,o;if(l.style.visibility="visible",m&&showEle(m),n&&showEle(n),b=new Image,c=a.toDataURL("image/png"),b.src=c,window.isMobile)j="margin-bottom:10px;margin-top: 44px;",f&&(j=""),k=$("#showImgBox"),k[0]||(k=$(divContent).find(".reportimgwrap"),k[0]||(k=$("<div class='reportimgwrap'></div>").insertAfter(divContent))),o='<a href="javascript:" style="text-align:center;color:#FF6A00;width:40px;height: 24px;line-height: 24px;display:inline-block;background-color:#FFF3EB;border:1px solid #FFC399;font-size:12px;float:right;margin-top: 10px;border-radius: 2px">返回</a>',k.html('<div style="'+j+'" class="reportimg"></div><div style="padding:0 20px;color:#FF6A00;background:#FFF3EB;font-size:14px;position: fixed;top:0;left:0;right:0;height:44px;line-height:44px;">已生成图片，长按下图保存图片'+o+"</div>"),k.find(".reportimg").html(b),k.show().prev().hide(),k.find("a").click(function(){$(".ranking__btn").show(),$(".not_wrap").show(),k.hide().prev().show()}),isCache=!0,setTimeout(function(){window.scroll(0,0)},300);else if(browserIsIe())try{d=a.msToBlob(),e=new Blob([d]),window.navigator.msSaveBlob(e,activityId+"_"+joinId+".png")}catch(g){alert("提示：您的浏览器版本过低，请直接截图保存！")}else h=document.createElement("a"),h.download=activityId+"_"+joinId,i=new MouseEvent("click"),h.href=b.src,h.dispatchEvent(i)})},0)},s(divContent.getElementsByTagName("img")),void 0))}function browserIsIe(){var a=window.navigator.userAgent.toLowerCase();return a.indexOf("edge")>-1?!0:window.ActiveXObject||"ActiveXObject"in window?!0:!1}function loadCanvasJs(){var c,e,a=0,b=navigator.userAgent;-1==b.indexOf("wxwork")&&b.toLowerCase().indexOf("micromessenger")>-1&&(a=1),c=window.location.href.toLowerCase(),c.indexOf("/complete")>-1,e=document.createElement("script"),e.type="text/javascript",e.src="//image.wjx.com/wxloj/html2canvas.js",document.getElementsByTagName("head")[0].appendChild(e),(window.ActiveXObject||"ActiveXObject"in window)&&(e=document.createElement("script"),e.type="text/javascript",e.src="//image.wjx.com/wxloj/bluebird.js",document.getElementsByTagName("head")[0].appendChild(e))}var isCache=!1;setTimeout(function(){loadCanvasJs()},100);