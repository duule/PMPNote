function showEle(a){a.style.display=""}function hideEle(a){a.style.display="none"}function corsHandler(a){Array.prototype.forEach.call(a,function(a){var b=a.src,c="pubref.paperol.cn",d=b.replace("pubnew.paperol.cn",c).replace("pubnewfr.paperol.cn",c).replace("pubali.sojump.cn",c).replace("pubalifr.sojump.cn",c);a.src=d})}function employeeImage(a){var c,d,e,f,g,h,i,b=a;b.style.visibility="hidden",c=document.getElementById("divSetDisplay"),d=document.getElementById("hrefSetReport"),c&&hideEle(c),d&&hideEle(d),window.isMobile&&($(".ranking__btn").hide(),e=document.getElementById("divCepingResult"),""==divdsc.style.display&&(divContent=divdsc),e&&""==e.style.display&&(divContent=e)),f=divContent.clientWidth,g=divContent.clientWidth,h=document.createElement("canvas"),h.width=2*f,h.height=2*g,h.style.width=f+"px",h.style.height=g+"px",i=h.getContext("2d"),i.scale(2,2),corsHandler(divContent.getElementsByTagName("img")),html2canvas(divContent,{canvas:h,useCORS:!0}).then(function(a){var e,f,g,h,j,k,l,m;if(b.style.visibility="visible",c&&showEle(c),d&&showEle(d),e=new Image,f=a.toDataURL("image/png"),e.src=f,window.isMobile)l="margin-bottom:10px;",m="padding:20px 0 20px 20px;",6==window.cqType&&(l="",m="padding-left:20px;"),$("#showImgBox").html('<div style="'+l+'"></div><div style="'+m+'color:red;background:#fff;font-size:14px;">提示：报告已转成图片，长按上图保存。<a href="javascript:" onclick="goBack();" style="color:#0095ff;">返回</a></div>'),$("#showImgBox div:eq(0)").html(e),$("#showImgBox").show().siblings(".chuangGuanWrap").hide(),setTimeout(function(){window.scroll(0,99999)},300);else if(browserIsIe())try{g=a.msToBlob(),h=new Blob([g]),window.navigator.msSaveBlob(h,activityId+"_"+joinId+".png")}catch(i){alert("提示：您的浏览器版本过低，请直接截图保存！")}else j=document.createElement("a"),j.download=activityId+"_"+joinId,k=new MouseEvent("click"),j.href=e.src,j.dispatchEvent(k)})}function goBack(){$(".ranking__btn").show(),$("#showImgBox").hide().siblings(".chuangGuanWrap").show()}function browserIsIe(){var a=window.navigator.userAgent.toLowerCase();return a.indexOf("edge")>-1?!0:window.ActiveXObject||"ActiveXObject"in window?!0:!1}if(window.ActiveXObject||"ActiveXObject"in window){var script=document.createElement("script");script.type="text/javascript",script.src="//image.wjx.com/wxloj/bluebird.js",document.getElementsByTagName("head")[0].appendChild(script)}